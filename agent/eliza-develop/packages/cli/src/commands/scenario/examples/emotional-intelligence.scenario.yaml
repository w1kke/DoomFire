name: 'Emotional Intelligence Assessment'
description: "Test agent's ability to handle emotional conversations and provide empathetic responses"

plugins:
  - name: '@elizaos/plugin-bootstrap'
    enabled: true
  - name: '@elizaos/plugin-sql'
    enabled: true
  - name: '@elizaos/plugin-openai'
    enabled: true

environment:
  type: local

run:
  - name: 'Stressed user with urgent deadline'
    input: "I'm really stressed about this deadline and your software just crashed on me!"

    conversation:
      max_turns: 5
      timeout_per_turn_ms: 25000

      user_simulator:
        model_type: 'TEXT_LARGE'
        temperature: 0.8
        max_tokens: 200
        persona: 'highly stressed professional facing critical work deadline'
        objective: 'get software working immediately while feeling heard and supported'
        style: 'initially panicked and stressed, becomes calmer if treated with empathy'
        constraints:
          - 'Express high stress and urgency about work deadline'
          - 'Mention the impact on important work project'
          - 'Become more cooperative if agent shows understanding'
          - 'Appreciate acknowledgment of the stressful situation'
          - 'Still feel time pressure even when helped'
        emotional_state: 'high anxiety, frustration, time pressure'
        knowledge_level: 'intermediate'

      termination_conditions:
        - type: 'user_expresses_satisfaction'
          keywords: ['thank you', 'that helps', 'feeling better', 'less stressed']
        - type: 'agent_provides_solution'
          keywords: ['try this', 'this should work', 'quick fix']
        - type: 'custom_condition'
          llm_judge:
            prompt: "Has the agent adequately addressed both the technical issue and the user's emotional state?"
            threshold: 0.8

      turn_evaluations:
        - type: 'llm_judge'
          prompt: "Did the agent acknowledge and respond appropriately to the user's stress and urgency?"
          expected: 'yes'
        - type: 'llm_judge'
          prompt: 'Did the agent avoid dismissive language and show empathy?'
          expected: 'yes'

      final_evaluations:
        - type: 'llm_judge'
          prompt: 'Did the agent demonstrate emotional intelligence in handling this stressed user?'
          expected: 'yes'
          capabilities:
            - "Acknowledged user's emotional state and stress level"
            - 'Showed appropriate empathy and understanding'
            - 'Prioritized urgent problem solving'
            - 'Avoided dismissive or minimizing language'
            - 'Provided reassurance while working on solution'
            - 'Maintained calm and supportive tone throughout'
        - type: 'user_satisfaction'
          satisfaction_threshold: 0.7
          measurement_method: 'sentiment_analysis'
        - type: 'conversation_flow'
          required_patterns:
            - 'empathy_then_solution'
          flow_quality_threshold: 0.8
        - type: 'context_retention'
          test_memory_of: ['deadline stress', 'software crash', 'work project']
          retention_turns: 3
          memory_accuracy_threshold: 0.8

    evaluations:
      - type: 'string_contains'
        value: 'stress'
      - type: 'llm_judge'
        prompt: 'Did the response show emotional intelligence?'
        expected: 'yes'

judgment:
  strategy: all_pass
